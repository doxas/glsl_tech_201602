
#### 自己紹介

杉本 雅広（doxas）

Twitter : <a href="https://twitter.com/h_doxas" target="_blank">@h_doxas</a>

![](sample.png)

---

#### 本日のテーマ

本日は *初めてのシェーダに挑戦しよう！ GLSL Sandbox 入門編* ということで、かなり初歩的なところからお話しできたらと思っています。

GLSL や シェーダについては、その名前や呼び方しか知らないという方でもわかるように、できる限り噛み砕いた内容でお届けします。


---

#### 本日のテーマ

今回の内容を見聞きしたことがきっかけになって、ひとりでも多くの人が WebGL や GLSL に興味を持ってもらえたらうれしいです。

<span class="capt">気楽な感じで聞いてもらえればと思います</span>

---

#### GLSL あるいはシェーダとは

入門的な内容にするとは言ったものの、今回は「GLSL 勉強会」なので、さすがに GPU や GLSL についての知識が皆無という方はいないと思います。

GPU は CPU と比較して高速に演算処理を行うことができる、くらいのやんわりとした認識の方はもしかしたらいるかもしれませんね。でも、最初のとっかかりとしては、そんな曖昧な知識でも個人的には全然構わないと思っています。

<span class="capt">事実、私も最初はそんな感じでした</span>

---

#### GLSL あるいはシェーダとは

シェーダという言葉にはいろんな意味や捉え方があると思いますが、誤解を恐れずに極めて平易に言えば、シェーダとは *GPU を利用して高速に演算を行うことができる機構* と言えるのではないでしょうか。

そんなシェーダを記述するための手段のひとつが GLSL であり、WebGL に限らず様々なシーンで利用されています。

---

#### ウェブにおける GLSL の活用

WebGL の普及に合わせて、ウェブ上でも GLSL を用いた事例が増えてきています。

特に、フラグメントシェーダを記述しその場で実行することができるウェブサービスが近年では人気を得ているように思います。

いくら WebGL が javascript ベースで手軽とは言っても、やはりひとまず動くところまで持っていくだけでも結構大変です。その点、この手のサービスを用いることでより簡単に、シェーダの楽しさや面白さを誰でも体験することができます。

---

#### ウェブにおける GLSL の活用

**Shadertoy**

<a href="https://www.shadertoy.com/" target="_blank">Shadertoy BETA</a>

世界最高峰のシェーダを閲覧できるガチ勢の巣窟。

---

#### ウェブにおける GLSL の活用

**vertexshaderart.com**

<a href="https://www.vertexshaderart.com/" target="_blank">vertexshaderart.com</a>

頂点シェーダを活用したシェーダエディタを装備。

---

#### ウェブにおける GLSL の活用

**GLSL.io**

<a href="http://transitions.glsl.io/" target="_blank">GLSL.io – Open Collection of GLSL Transitions</a>

シェーダを用いた画面遷移を実装できる。

---

#### ウェブにおける GLSL の活用

**Interactive Shader Format**

<a href="http://www.interactiveshaderformat.com/" target="_blank">Interactive Shader Format</a>

VJ などに使われる ISF フォーマットが記述可能。

---

#### ウェブにおける GLSL の活用

**GLSL Sandbox**

<a href="http://glslsandbox.com/" target="_blank">GLSL Sandbox Gallery</a>

WebGL 最初期の頃からある老舗的存在。

---

#### ウェブにおける GLSL の活用

このように、ウェブ上をちょっと漁っただけでも結構いろいろなサイトが出てきます。

これらに共通するのは、GLSL を用いてシェーダを記述し、その場で WebGL を使って即座に結果を確認できることです。

今回は、みなさんにも GLSL Sandbox を使ってもらって、実際にその即席シェーダ体験を味わっていただこうと思います。

---

#### 予備知識

ウェブ上で GLSL を実行するには WebGL を用います。WebGL はその仕様上、2 種類のシェーダを扱うことが可能です。

先ほども少し名前が登場しましたが「頂点シェーダ」と「フラグメントシェーダ」がそれです。

---

#### 予備知識

頂点シェーダはその名のとおり、頂点を扱うことを主な役割とし、座標変換などを行います。

頂点シェーダで座標変換が行われた後、いくつかのプロセスを経てから「画面にどの頂点を描くべきか」が決まります。

---

#### 予備知識

どの頂点が描かれるかが決まると、実際に着色する作業に移ります。

この着色作業を担っているのがフラグメントシェーダです。先述の GLSL の活用事例では、一部を除きほとんどがこのフラグメントシェーダを記述できるサービスでした。つまり *画面内にどんな色を出力するか* これに注目してシェーダを記述していくわけですね。

<span class="capt">頂点が描かれることになった全てのピクセルに同じシェーダが走ります</span>

---

#### 予備知識

シェーダは確かに高速なのですが、たとえばマウスカーソルの位置や、どれくらいの時間が経過したのかといった情報は、CPU 上で動いている javascript が持っています。

シェーダはこういった CPU 側にある情報を受け取るためのインタフェースを備えていて、これは GLSL の場合 *uniform 変数* と呼ばれます。

シェーダ内で uniform というキーワードを見かけたら、これが javascript から送られてきた何かしらの情報であると考えればいいわけですね。

---

#### 予備知識

最終的に `gl_FragColor` という組み込みの変数に RGBA で色の情報を出力してやると、それがフラグメントシェーダによってディスプレイに送られます。

似たような名前の変数に `gl_FragCoord` というのがありますが、こちらはスクリーン空間で今から処理されるピクセルの座標をあらかじめ格納しています。

これらの組み込み変数を使って、シェーダを記述していきます。

---

#### さあやってみよう

さて、本当にごく簡単にでしたがシェーダについての予備知識は揃いました。

あとは実際に体験しながら、少しずつ自分のペースで覚えていくといいでしょう。

今回は GLSL Sandbox を使って、みなさんと一緒に簡単なシェーダを記述してみたいと思います。

---

#### GLSL Sandbox

GLSL Sandbox

http://glslsandbox.com/

---

#### 最後に

さていかがでしたでしょうか。

本当に簡単な内容でしかなかったですが、シェーダに興味を持っていただけるきっかけくらいにはなったでしょうか。

GLSL は本当に気軽に記述できるシェーダ記述言語だと思いますので、肩肘張らず、楽しんでみてください。

---

#### 最後に

ありがとうございました！


---

```
#ifdef GL_ES
precision mediump float;
#endif

#extension GL_OES_standard_derivatives : enable

uniform float time;
uniform vec2 mouse;
uniform vec2 resolution;

void main( void ) {
	vec2 position = (( gl_FragCoord.xy / resolution.xy ) - 0.5) * 5.0;
	float wave = sin(position.x * time * 10.0);
	gl_FragColor = vec4(vec3(wave, wave * position.y, position.x * wave),  1.0);
}
```


